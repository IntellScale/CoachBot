from io import BytesIO
import base64

def create_report_file(excel_data):

    template = f'''
    Ð”Ð°Ñ‚Ð° - {excel_data[0]}

    Ð¢Ñ€ÐµÐ½ÑƒÐ²Ð°Ð»ÑŒÐ½Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð° -
    Ð¢Ð¸Ð¶Ð´ÐµÐ½ÑŒ -

    ðŸŸ¢ Ð‘Ð»Ð¾Ðº 1 Ð¥Ð°Ñ€Ñ‡ÑƒÐ²Ð°Ð½Ð½Ñ
    - Ð·Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ð¼ÐµÑ‚Ð° Ð½Ð° Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ:
    {excel_data[2]}

    ÐšÐ¾Ð¼ÐµÐ½Ñ‚Ð°Ñ€ Ð¿Ð¾ Ñ€Ð¾Ð·Ð´Ñ–Ð»Ñƒ â¤µï¸
    1 Ð¡Ð¼Ñ–Ñ‚Ñ‚Ñ”Ð²Ð° Ñ—Ð¶Ð° Ð² Ñ…Ð°Ñ€Ñ‡ÑƒÐ²Ð°Ð½Ð½Ñ–: {excel_data[3]}
    2 ÐšÐ¾Ð¼Ñ„Ð¾Ñ€Ñ‚ Ð¼Ñ–ÑÑ†Ñ Ð¿Ñ€Ð¸Ð¹Ð¾Ð¼Ñƒ Ñ—Ð¶Ñ–: {excel_data[4]}
    3 ÐžÑ‚Ð¾Ñ‡ÐµÐ½Ð½Ñ Ð»ÑŽÐ´Ð¸ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ñ—Ð¶Ñ–: {excel_data[5]}
    4 Ð“Ð°Ð´Ð¶ÐµÑ‚Ð¸ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ñ—Ð¶Ñ–: {excel_data[6]}
    5 Ð£Ð²Ð°Ð³Ð° Ð½Ð° Ñ—Ð¶Ñ–: {excel_data[7]}
    6 Ð•Ð¼Ð¾Ñ†Ñ–Ñ— Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ñ—Ð¶Ñ–: {excel_data[8]}

    ÐÐ½Ð°Ð»Ñ–Ñ‚Ð¸ÐºÐ°
    Ð¡ÐµÑ€ÐµÐ´Ð½Ñ ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ Ð½Ð° Ð´ÐµÐ½ÑŒ
    Ð‘Ñ–Ð»ÐºÑ–Ð² - {excel_data[9]}
    Ð–Ð¸Ñ€Ð¾Ð² - {excel_data[10]}
    Ð’ÑƒÐ³Ð»ÐµÐ²Ð¾Ð´Ñ–Ð² - {excel_data[11]}
    ÐšÐšÐÐ› - {excel_data[12]}

    Ð’Ð°ÑˆÑ– Ð²Ð¸Ð¼Ñ–Ñ€ÑŽÐ²Ð°Ð½Ð½Ñ ÐºÐ³/ÑÐ¼ â€“
    Ð²ÐºÐ°Ð¶Ñ–Ñ‚ÑŒ Ñ€Ñ–Ð·Ð½Ð¸Ñ†ÑŽ +- Ð¿Ð¾Ñ€Ñ–Ð²Ð½ÑÐ½Ð¾ Ð· Ð¿Ð¾Ð¿ÐµÑ€ÐµÐ´Ð½Ñ–Ð¼Ð¸
    1. Ð’Ð°Ð³Ð° - {excel_data[13]}
    2. ÐŸÐ»ÐµÑ‡Ñ– - {excel_data[14]}
    3. Ð“Ñ€ÑƒÐ´Ð¸ - {excel_data[15]}
    4. Ð ÑƒÐºÐ° Ð¿Ñ€Ð°Ð²Ð° - {excel_data[16]}
    5. Ð ÑƒÐºÐ° Ð»Ñ–Ð²Ð° -  {excel_data[17]}
    6. Ð¢Ð°Ð»Ñ–Ñ - {excel_data[18]}
    7. Ð¡Ñ‚ÐµÐ³Ð½Ð° â€“ {excel_data[19]}
    8. Ð¡Ñ‚ÐµÐ³Ð½Ð° Ð¿Ñ€Ð°Ð²Ðµ - {excel_data[20]}
    9. Ð¡Ñ‚ÐµÐ³Ð½Ð° Ð»Ñ–Ð²Ðµ - {excel_data[21]}

    ÐŸÑ€Ð¾Ð´ÑƒÐ±Ð»ÑŽÐ¹Ñ‚Ðµ ÑÑ…ÐµÐ¼Ñƒ ÑÐ²Ð¾Ñ—Ñ… Ð´Ð¾Ð±Ð°Ð²Ð¾Ðº
    1 {excel_data[23]}
    
   
    

    ðŸŸ¢ Ð‘Ð»Ð¾Ðº 2 Ð’Ñ–Ð´Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ
    - Ð·Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ð¼ÐµÑ‚Ð° Ð½Ð° Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ:
    1 {excel_data[24]}
    
    

    ÐšÐ¾Ð¼ÐµÐ½Ñ‚Ð°Ñ€ Ð¿Ð¾ Ñ€Ð¾Ð·Ð´Ñ–Ð»Ñƒ â¤µï¸
    1 Ð Ð°Ð½ÐºÐ¾Ð²Ð¸Ð¹ Ñ€Ð¸Ñ‚ÑƒÐ°Ð»: {excel_data[25]}
    2 Ð¡Ð¾Ð½: {excel_data[26]}
    3 Ð¤Ñ–Ð·Ð¸Ñ‡Ð½Ð¸Ð¹ ÑÑ‚Ð°Ð½: {excel_data[27]}
    4 ÐŸÑÐ¸Ñ…Ñ–Ñ‡Ð½Ð¸Ð¹ ÑÑ‚Ð°Ð½: {excel_data[28]}
    5 ÐšÐ¾Ð½Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ñ†Ñ–Ñ ÑƒÐ²Ð°Ð³Ð°:{excel_data[29]}
    6 Ð¢Ñ€Ð°Ð²Ð¼Ð¸: {excel_data[30]}

    ðŸŸ¢ Ð‘Ð»Ð¾Ðº 3 Ð¢Ñ€ÐµÐ½ÑƒÐ²Ð°Ð»ÑŒÐ½Ð¸Ð¹
    - Ð·Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ð¼ÐµÑ‚Ð° Ð½Ð° Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ:
    1. {excel_data[31]}


    ÐšÐ¾Ð¼ÐµÐ½Ñ‚Ð°Ñ€ Ð¿Ð¾ Ñ€Ð¾Ð·Ð´Ñ–Ð»Ñƒ â¤µï¸
    1 ÐŸÑ–Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð¾ Ñ‚Ñ€ÐµÐ½ÑƒÐ²Ð°Ð½Ð½Ñ: {excel_data[32]}
    2 Ð—Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ñ€Ð¾Ð·Ð¼Ð¸Ð½ÐºÐ°: {excel_data[33]}
    3 ÐžÑÐ½Ð¾Ð²Ð½Ðµ Ñ‚Ñ€ÐµÐ½ÑƒÐ²Ð°Ð½Ð½Ñ: {excel_data[34]}
    4 Ð¢ÐµÑ…Ð½Ñ–ÐºÐ° Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð½Ñ: {excel_data[35]}
    5 ÐÐ°ÑÑ‚Ñ€Ñ–Ð¹ Ð½Ð° Ñ‚Ñ€ÐµÐ½ÑƒÐ²Ð°Ð½Ð½Ñ–: {excel_data[36]}
    6 Ð“Ð°Ð´Ð¶ÐµÑ‚Ð¸ Ð½Ð° Ñ‚Ñ€ÐµÐ½ÑƒÐ²Ð°Ð½Ð½Ñ–: {excel_data[37]}

    ðŸŸ¢ Ð‘Ð»Ð¾Ðº 4 Ð Ð¾Ð·Ð²Ð¸Ñ‚Ð¾Ðº
    - Ð·Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ð¼ÐµÑ‚Ð° Ð½Ð° Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ:
    1 {excel_data[38]}
   
    

    ÐšÐ¾Ð¼ÐµÐ½Ñ‚Ð°Ñ€ Ð¿Ð¾ Ñ€Ð¾Ð·Ð´Ñ–Ð»Ñƒ â¤µï¸ (4.1)
    1 Ð Ð¾Ð·Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº Ð´Ð½Ñ Ð·Ð° Ð³Ð¾Ð´Ð¸Ð½Ð°Ð¼Ð¸: {excel_data[39]}
    2 Ð Ð°Ð½ÐºÐ¾Ð²Ð¸Ð¹ Ð½Ð°ÑÑ‚Ñ€Ñ–Ð¹ Ð°Ñ„Ñ–Ñ€Ð¼Ð°Ñ†Ñ–Ñ: {excel_data[40]}
    3 ÐŸÐ¾ÑÐ¼Ñ–ÑˆÐºÐ° Ð¿Ñ€Ð¾Ñ‚ÑÐ³Ð¾Ð¼ Ð´Ð½Ñ: {excel_data[41]}
    4 ÐŸÐ¾Ð´ÑÐºÐ° Ð¿Ñ€Ð¾Ñ‚ÑÐ³Ð¾Ð¼ Ð´Ð½Ñ: {excel_data[42]}
    5 Ð©Ð¸Ñ€Ñ–ÑÑ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ ÑÑ‚Ð°Ð½Ñƒ 1/10: {excel_data[43]}
    6 Ð¡Ð¿Ð¾ÑÑ‚ÐµÑ€ÐµÐ¶ÐµÐ½Ð½Ñ ÑÐ²Ñ–Ñ‚Ñƒ: {excel_data[44]}
    7 Ð’Ñ–Ð´Ñ‡ÑƒÑ‚Ñ‚Ñ Ð´Ð·ÐµÑ€ÐºÐ°Ð»Ð° ÑÐ²Ñ–Ñ‚Ñƒ 1/10: {excel_data[45]}
    8 ÐÐ½Ð°Ð»Ñ–Ð· ÑÐ²Ð¾Ð³Ð¾ ÐºÐ¾Ð»Ð° ÑÐ¿Ñ–Ð»ÐºÑƒÐ²Ð°Ð½Ð½Ñ: {excel_data[46]}
    9 Ð”Ð¾Ð±Ñ€Ñ– ÑÐ¿Ñ€Ð°Ð²Ð¸: {excel_data[47]}
    10 Ð”Ð¾Ð±Ñ€Ñ– ÑÐ¿Ñ€Ð°Ð²Ð¸ Ð´Ð»Ñ Ñ‚Ð²Ð°Ñ€Ð¸Ð½: {excel_data[48]}
    11 Ð”Ð¾Ð±Ñ€Ñ– ÑÐ¿Ñ€Ð°Ð²Ð¸ Ð´Ð»Ñ Ñ€Ð¾ÑÐ»Ð¸Ð½: {excel_data[49]}
    12 Ð”Ð¾Ð±Ñ€Ñ– ÑÐ¿Ñ€Ð°Ð²Ð¸ Ð½ÐµÐ´Ð¾Ð±Ñ€Ð¸Ð¼ Ð»ÑŽÐ´ÑÐ¼: {excel_data[50]}
    13 ÐÐ°Ð²Ð¸Ñ‡ÐºÐ° Ñ€Ð°Ð´Ñ–Ñ‚Ð¸ Ð½ÐµÐ²Ð´Ð°Ñ‡Ð°Ð¼: {excel_data[51]}
    14 ÐÐµ Ð´Ð¾Ð±Ñ€Ñ– ÑÐ¿Ñ€Ð°Ð²Ð¸: {excel_data[52]}
    15 ÐÐ¾Ð²Ñ– Ð·Ð½Ð°Ð½Ð½Ñ: {excel_data[53]}
    16 Ð§Ð¸Ñ‚Ð°Ð½Ð½Ñ ÐºÐ½Ð¸Ð³: {excel_data[54]}
    17 ÐÐ¾Ð²Ñ– Ð½Ð°Ð²Ð¸Ñ‡ÐºÐ¸: {excel_data[55]}
    18 ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð° ÑÐ²Ð¾Ð³Ð¾ Ð´Ð¾ÑÐ²Ñ–Ð´Ñƒ: {excel_data[56]}
    19 Ð¢Ð²Ð¾Ñ€Ñ‡Ð° Ñ€Ð¾Ð±Ð¾Ñ‚Ð°: {excel_data[57]}
    20 Ð Ð¾Ð±Ð¾Ñ‚Ð° Ð· Ð´ÑƒÑˆÐµÑŽ 1/10: {excel_data[58]}

    21 Ð¡Ð¿Ñ€Ð¸Ð¹Ð½ÑÑ‚Ñ‚Ñ Ð¡Ð²Ñ–Ñ‚Ñƒ:
    - 21.1 Ð±Ð¾Ñ€Ð¾Ñ‚ÑŒÐ±Ð° Ñ–Ð· ÑÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸Ð¼Ð¸ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ñ–ÑÐ¼Ð¸: {excel_data[59]}
    - 21.2 Ð´Ð¾Ð²Ñ–Ñ€Ð° Ð´Ð¾ ÑÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¸Ñ… ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ñ–Ð¹: {excel_data[60]}

    22 Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ Ð½ÐµÐ³Ð°Ñ‚Ð¸Ð²Ð½Ð¸Ñ… Ð´ÑƒÐ¼Ð¾Ðº:
    ÐºÑ–Ð»ÑŒÐºÑ–ÑÑ‚ÑŒ - Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ð°
    - 22.1 Ð²Ð¾Ð»Ð¾Ñ†ÑŽÐ³Ð¸ Ð½ÐµÐºÐµÑ€Ð¾Ð²Ð°Ð½Ñ– Ð´ÑƒÐ¼ÐºÐ¸: {excel_data[61]}
    - 22.2 Ð·Ð»Ñ– Ð¿Ð¾Ð¼Ð¸ÑÐ»Ð¸: {excel_data[62]}

    23 Ð¤Ñ–Ð»ÑŒÑ‚Ñ€ Ñ‡Ð¸ÑÑ‚Ð¾Ñ‚Ð¸ ÑÐ²Ñ–Ð´Ð¾Ð¼Ð¾ÑÑ‚Ñ–:
    - 23.1 Ð´ÑƒÐ¼ÐºÐ¸: {excel_data[63]}
    - 23.2 ÐµÐ¼Ð¾Ñ†Ñ–Ñ—: {excel_data[64]}
    - 23.3 Ð´Ñ–Ñ—: {excel_data[-1]}

    24 ÐÐ°Ð¿Ð¾Ð²Ð½ÐµÐ½Ð½Ñ Ð¾Ð±Ñ€Ð°Ð·Ñƒ ÑÐ²Ð¾Ñ”ÑŽ ÑƒÐ²Ð°Ð³Ð¾ÑŽ:
    - 24.1 Ð´Ð¾Ð²Ð³Ð¾ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð²Ð° Ð¼ÐµÑ‚Ð°: {excel_data[65]}
    - 24.2 ÑÐ¿Ð¸ÑÐ¾Ðº Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³ Ð¿Ñ€Ñ–Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚Ñ–Ð²: {excel_data[66]}
    - 24.3 Ñ€Ð¾Ð·ÑƒÐ¼Ñ–Ð½Ð½Ñ Ð²Ñ–Ð´ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð Ð´Ð¾ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð‘: {excel_data[67]}

    ÐžÑÐ¾Ð±Ð¸ÑÑ‚Ð¸Ð¹ Ð´ÐµÐ½ÑŒ: https://t.me/+m3us-GADQkc1M2Ni

    âœ… ÐŸÑ–Ð´ÑÑƒÐ¼Ð¾Ðº
    Ð”Ð°Ð¹Ñ‚Ðµ Ð¾Ñ†Ñ–Ð½ÐºÑƒ ÑÐ²Ð¾Ñ—Ð¹ Ñ€Ð¾Ð±Ð¾Ñ‚Ñ– - Ð¾Ð¿Ð¸ÑˆÑ–Ñ‚ÑŒ ÑÐº Ð±Ð°Ñ‡Ð¸Ñ‚Ðµ â¤µï¸
    {excel_data[68]}


    Ð’Ñ–Ð´Ð¿Ñ€Ð°Ð²Ð¸Ñ‚Ð¸ Ð¼Ñ–Ð½Ñ–Ð¼ÑƒÐ¼ Ñ€Ð°Ð· Ð½Ð° Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ 
    - Ð´ÐµÐ½ÑŒ ÑÐ²Ð¾Ð³Ð¾ Ñ…Ð°Ñ€Ñ‡ÑƒÐ²Ð°Ð½Ð½Ñ 
    https://t.me/athletfood

    Ð—Ð°Ð¿Ð¸Ñ‚Ð°Ð½Ð½Ñ Ñ‚Ñ€ÐµÐ½ÐµÑ€Ñƒ Ð½Ð° Ð±ÑƒÐ´ÑŒ-ÑÐºÑƒ Ñ‚ÐµÐ¼Ñƒ 
    https://t.me/+lfMlTDuDBX01MjIy'''

    
    return template

def create_stat_message(statistics: dict) -> str:
    message = ""

    for key, value in statistics.items():
        message += f"{key}:\n"
        for stat_type, stat_value in value.items():
            if isinstance(stat_value, dict):
                message += f"  - {stat_type}:\n"
                message += f"    - Min: {stat_value.get('min', 'N/A')}\n"
                message += f"    - Max: {stat_value.get('max', 'N/A')}\n"
                message += f"    - Avg: {stat_value.get('avg', 'N/A')}\n"
                # Check if 'plot_path' key exists in the dictionary
                if 'plot_path' in stat_value:
                    # Embed the plot as a base64-encoded image in the HTML message
                    plot_path = stat_value['plot_path']
                    plot_image = generate_base64_plot(plot_path)
                    message += f"    - Plot: {plot_image}\n"
            else:
                # Handle cases where stat_value is not a dictionary
                message += f"  - {stat_type}: {stat_value}\n"

        message += "\n"

    return message

def generate_base64_plot(plot_path):
    # Read the plot image
    with open(plot_path, "rb") as plot_file:
        plot_data = plot_file.read()

    # Encode the image data as base64
    base64_plot = base64.b64encode(plot_data).decode("utf-8")

    # Create an HTML image tag with the base64-encoded image
    plot_image = f"<img src='data:image/png;base64,{base64_plot}'/>"

    return plot_image